# This is an example environment file.
# Copy this file to .env and fill in your actual configuration values.
# The .env file is git-ignored and should NOT be committed to source control.

# -----------------------------------------------------------------------------
# SECTION 1: CORE APPLICATION CONFIGURATION (REQUIRED)
# These variables are essential for the server to start and function correctly.
# -----------------------------------------------------------------------------

# The full connection string for your MongoDB instance.
DATABASE_URL="mongodb://user:password@localhost:27017/flutter_news_app_api_server_full_source_code_db"

# A secure, randomly generated secret for signing JSON Web Tokens (JWTs).
JWT_SECRET_KEY="your-super-secret-and-long-jwt-key"

# REQUIRED FOR PRODUCTION: The specific origin URL of your web client (e.g., the dashboard).
# This is critical for allowing the web app to make requests to the API.
# For local development, this can be left unset as 'localhost' is allowed by default.
CORS_ALLOWED_ORIGIN="https://your-dashboard.com"

# Sets the single administrator account for the application.
# On server startup, the system ensures that the user with this email is the
# one and only administrator.
OVERRIDE_ADMIN_EMAIL="admin@example.com"


# -----------------------------------------------------------------------------
# SECTION 2: EXTERNAL PROVIDER CREDENTIALS
# Define your API keys and secrets here. These are referenced by various features.
# -----------------------------------------------------------------------------

# --- Firebase / Google Cloud ---
# This single service account is used for FCM, Google Analytics, and GCS.
FIREBASE_PROJECT_ID="your-firebase-project-id"
FIREBASE_CLIENT_EMAIL="your-firebase-client-email"
FIREBASE_PRIVATE_KEY="your-firebase-private-key"
GCS_BUCKET_NAME="your-gcs-bucket-name"

# --- AWS S3 ---
# Required if STORAGE_PROVIDER is set to "s3".
# Ensure the IAM user has S3 read/write permissions for the specified bucket.
AWS_ACCESS_KEY_ID="your-aws-access-key-id"
AWS_SECRET_ACCESS_KEY="your-aws-secret-access-key"
AWS_REGION="us-east-1"
AWS_BUCKET_NAME="your-s3-bucket-name"
# Optional: Custom S3 endpoint (e.g., for MinIO or compatible services)
# AWS_S3_ENDPOINT="https://s3.us-east-1.amazonaws.com"
# A shared secret to secure the S3 webhook.
# Append this to your SNS subscription URL: https://api.domain.com/api/v1/webhooks/storage/s3?secret=YOUR_SECRET
S3_WEBHOOK_SECRET="your-random-secure-string"

# --- OneSignal ---
# Used for: Push Notifications, Email Delivery
# Note: For Android Push, ensure FCM Server Key is set in OneSignal dashboard.
ONESIGNAL_APP_ID="your-onesignal-app-id"
ONESIGNAL_REST_API_KEY="your-onesignal-rest-api-key"

# --- SendGrid ---
# Used for: Email Delivery
SENDGRID_API_KEY="your-sendgrid-api-key"
# The base URL for the SendGrid API. Defaults to "https://api.sendgrid.com".
# SENDGRID_API_URL="https://api.sendgrid.com"

# --- Mixpanel ---
# Used for: Analytics
MIXPANEL_PROJECT_ID="your-mixpanel-project-id"
MIXPANEL_SERVICE_ACCOUNT_USERNAME="your-mixpanel-service-account-username"
MIXPANEL_SERVICE_ACCOUNT_SECRET="your-mixpanel-service-account-secret"

# -----------------------------------------------------------------------------
# SECTION 3: FEATURE CONFIGURATION
# -----------------------------------------------------------------------------
# ⚠️ PROVIDERS SELECTION GUIDE:
#
# [STATIC] - Configured explicitly in this file.
#  - Email Service 
#
# [DYNAMIC] - Controlled remotely via the Admin Dashboard.
#  - Push Notifications, Analytics, Ads 
#
# Note: For Dynamic Features, you must still provide the API credentials for all providers in
# Section 2, but the active provider is switched at runtime via the Dashboard.
# -----------------------------------------------------------------------------

# --- Storage Provider (Static) ---
# Select the active provider: "gcs" (Google Cloud Storage) or "s3" (AWS S3).
STORAGE_PROVIDER="gcs"

# --- Email Service (Static) ---
# Select the active provider: "sendgrid", "onesignal", or "logging" (dev only).
EMAIL_PROVIDER="sendgrid"
DEFAULT_SENDER_EMAIL="noreply@example.com"
# The Template ID for the One-Time Password (OTP) email.
# Required for both SendGrid (Dynamic Template ID) and OneSignal (Template ID).
OTP_TEMPLATE_ID="d-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"

# --- Analytics ---
# The ID of your Google Analytics 4 property.
# Note: This requires the Firebase credentials from Section 3 to be configured
# as it uses the same authentication mechanism.
GOOGLE_ANALYTICS_PROPERTY_ID="your-ga4-property-id"

# --- Media Uploads ---
# Whitelisted MIME types for different upload purposes.
# Provide as a comma-separated list (e.g., "image/jpeg,image/png").
MEDIA_PROFILE_PHOTO_MIME_TYPES="image/jpeg,image/png,image/webp"
MEDIA_HEADLINE_IMAGE_MIME_TYPES="image/jpeg,image/png,image/webp"
MEDIA_TOPIC_IMAGE_MIME_TYPES="image/jpeg,image/png,image/webp"
MEDIA_SOURCE_IMAGE_MIME_TYPES="image/jpeg,image/png,image/webp"

# Maximum file size in Megabytes (MB) for different upload purposes.
MEDIA_PROFILE_PHOTO_MAX_SIZE_MB="5"
MEDIA_HEADLINE_IMAGE_MAX_SIZE_MB="10"
MEDIA_TOPIC_IMAGE_MAX_SIZE_MB="2"
MEDIA_SOURCE_IMAGE_MAX_SIZE_MB="2"


# -----------------------------------------------------------------------------
# SECTION 4: API SECURITY & RATE LIMITING (OPTIONAL)
# Fine-tune security settings. Defaults are provided if these are not set.
# -----------------------------------------------------------------------------

# Limit for the /auth/request-code endpoint (requests per window). Defaults to 3.
# RATE_LIMIT_REQUEST_CODE_LIMIT=3

# Window for the /auth/request-code endpoint, in hours. Defaults to 24.
# RATE_LIMIT_REQUEST_CODE_WINDOW_HOURS=24

# Limit for the generic /data API endpoints (requests per window). Defaults to 1000.
# RATE_LIMIT_DATA_API_LIMIT=1000

# Window for the /data API endpoints, in minutes. Defaults to 60.
# RATE_LIMIT_DATA_API_WINDOW_MINUTES=60


# -----------------------------------------------------------------------------
# SECTION 5: ADVANCED & MISCELLANEOUS CONFIGURATION (OPTIONAL)
# -----------------------------------------------------------------------------

# The duration for which a JWT is valid, in hours. Defaults to 720 (30 days).
# JWT_EXPIRY_HOURS="720"

# The cache duration for the CountryQueryService, in minutes. Defaults to 15.
# COUNTRY_SERVICE_CACHE_MINUTES=15
